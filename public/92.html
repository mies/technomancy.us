<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1' />
    <title>hiker dot rb - Technomancy</title>
    <script src="/static/prototype.js" type="text/javascript"></script>

    <link href="http://technomancy.us/feed/atom" rel="alternate" type="application/atom+xml"/>
    <link rel='stylesheet' href='/static/style.css' type='text/css' />
  </head>

  <body>

    <div id='background'>
      <img src='/static/i/top.png' alt='Technomancy' border='0' id='corner' />

      <div id='wrapper'> &nbsp;

      <div id='nav'>
        <ul>
          <li><a href='/'>blog</a></li>
          <li><a href='/resume'>r&eacute;sum&eacute;</a></li>
          <li><a href='/contact'>contact</a></li>
          <li><a href='/meta'>meta</a></li>
          <li><a href='http://dev.technomancy.us'>projects</a></li>
        </ul>

      </div><!-- end nav -->

      <p id='tagline'>Any sufficiently advanced technology is indistinguishable from magic.</p>

      <div id='content'>
        <h2>{ blog }</h2><div id='sidebar'>

        <h3>What you say?</h3>

        <p class='explain'>These are the technology musings of Phil
        Hagelberg. I write Ruby and Javascript code for a living, but I also spend a lot of
        time considering how to do so in the most efficient manner. This
        necessarily involves good-sized chunks of Emacs lisp.</p>

        <p class='explain'>I've got a separate <a href="http://philisha.net">blog for
        personal thoughts</a> and a <a href="http://dev.technomancy.us">wiki</a>
        for my projects.</p>

        <form action='http://www.google.com/search' name='searchbox' method='get'>
          <input type='hidden' name='sitesearch' value='technomancy.us' />
          <input type='text' name='q' size='9' value='Search' class='form-text'
                 onfocus="if (this.value=='Search') value='';"
                 onblur="if (this.value=='') value='Search';" />
          <input type='submit' value='&#187;' class='button' title="Because I didn't want to code search myself" />
        </form>

        <p><a href='/feed/atom' title='Syndication is your friend'><img src='/static/i/feedIcon.png' alt='feed' align='left' /> Feed</a></p>

        <h3>Fellow Hackers</h3>
        <ul>
          <li><a href='http://arko.net/' rel='friend met colleague'>andr&eacute; arko</a></li>
          <li><a href='http://brainspl.at' rel='friend met colleague'>ezra Z</a></li>
          <li><a href='http://blog.livollmers.net/' rel='friend colleague met'>alex</a></li>
          <li><a href='http://userprimary.net/user' rel='frient colleague met'>seth</a></li>
          <li><a href='http://www.lathi.net' rel='friend colleague met'>doug alcorn</a></li>
          <li><a href='http://blog.hasmanythrough.com' rel='friend colleague met'>josh susser</a></li>
          <li><a href='http://yehudakatz.com'>katz</a></li>
          <li><a href='http://evil.che.lu' rel='friend colleague'>evilchelu</a></li>
          <li><a href='http://jw.fi' rel='friend colleague'>unfo-</a></li>
          <li><a href='http://metaatem.com' rel='friend colleague met'>kastner</a></li>
          <li><a href='http://www.anarchaia.org/'>anarchaia</a></li>
          <li><a href='http://blog.codahale.com' rel='friend colleague met'>coda hale</a></li>
          <li><a href='http://gilesbowkett.blogspot.com' rel='colleague'>giles bowkett</a></li>
          <li><a href='http://on-ruby.blogspot.com/' rel='colleague met'>pate</a></li>
          <li><a href='http://schneier.com/blog' title='SecurityInsight'>bruce schneier</a></li>
          <li><a href='http://tbray.org/ongoing' rel='met' title='t1m'>tim bray</a></li>
          <li><a href='http://diveintomark.org'>mark pilgrim</a></li>
          <li><a href='http://intertwingly.net'>sam ruby</a></li>
          <li><a href='http://hackety.org' rel='met'>hackety</a></li>
          <li><a href='http://redhanded.hobix.com/' rel='met' title='Lucky Stiff and Friends'>redHanded</a></li>
          <li><a href='http://eigenclass.org' title="maybe if i read this more often i'll get smarter and understand it">mauricio</a></li>
          <li><a href='http://onestepback.org' title='the santa claus of Ruby'>jim weirich</a></li>
          <li><a href='http://ejohn.org'>john resig</a></li>
          <li><a href='http://steve-yegge.blogspot.com/' title='mostly he is listed because of emacs'>steve yegge</a></li>
        </ul>

        <h3 title='aggregation is key here'>Communities</h3>
        <ul>
          <li><a href='http://planet.lisp.org' title="(grok 'lisp)">planet lisp</a></li>
          <li><a href='http://planet.emacsen.org' title='denizens of #emacs'>planet emacs</a></li>
          <li><a href='http://planetruby.0x42.net' title='Yes, it runs on Python'>planet ruby</a></li>
          <li><a href='http://planet.caboo.se' title='my latest planet'>planet caboose</a></li>
          <li><a href='http://planet.ubuntu.com' title='humanity'>planet ubuntu</a></li>
          <li><a href='http://planet.mozilla.org' title='Gecko will save us'>planet mozilla</a></li>
          <li><a href='http://radar.oreilly.com/' title='there are those that call me... tim'>planet o'reilly</a></li>
        </ul>

        <h3><a href='http://dev.technomancy.us/'>Projects</a></h3>
        <ul>
          <li><a href='http://bus-scheme.rubyforge.org'>bus scheme</a></li>
          <li><a href='http://augment.rubyforge.org'>augment</a></li>
          <li><a href='http://www.emacswiki.org/cgi-bin/wiki/ElUnit' title='Emacs Lisp TDD'>elunit</a></li>
          <li><a href='http://rinari.rubyforge.org' title='rails emacs mode'>rinari</a></li>
          <li><a href='http://concour.se' title='railsday 06 project'>Concourse</a></li>
          <li><a href='http://rubyforge.org/projects/rplanet' title='Feed Aggregator'>rPlanet</a></li>
          <li><a href='http://rav.rubyforge.org/' title='Rails Application Visualizer'>rav</a></li>
          <li><a href='http://cartographer.rubyforge.org' title='Google Maps in Rails'>Cartographer</a></li>
          <li><a href='http://dev.technomancy.us/ebby' title='collaborative editing with Emacs'>ebby</a></li>
        </ul>

      </div><!-- end sidebar -->

      <div class='post'>
        <h3><a href='/92'>hiker dot rb</a></h3>

        <div>
          <p>I <a href='/88'>mentioned before</a> that I have some code for
  mapping geotagged photos on Google Maps. I've gotten a chance to
  wrap that up and polish it for release. May I
  present: <tt>hiker.rb</tt>. Thanks to a tip from
  an <a href='/88#c'>anonymous commenter</a> my code now creates
  detail bubbles that include the photo rather than just a link to
  it. You can
  see <a href='http://maps.google.com/?q=http://hagelb.org/victoria2.kml'>a
  couple</a> <a href='http://maps.google.com/?q=http://hagelb.org/edwards3.kml'>examples
  of it</a>.
</p>

<p>Unfortunately the process of going from a set of photos and a GPS
  tracks file to a KML file (which is what Google Maps reads) is
  somewhat involved. First there's the fact that no mainstream GPS
  manufacturer uses a sane format. You need a program
  called <a href='http://www.gpsbabel.org'>gpsbabel</a> to do the
  conversion into
  the <a href='http://www.topografix.com/gpx.asp'>GPX</a> format. Say
  you've got a saved GPS tracks from Magellan GPS that you took on your hike called myhike.log and
  your photos from the hike in a directory called hike_photos.</p>

<pre class='code'>
$ gpsbabel -i magellan -o gpx myhike.log myhike.gpx
</pre>

<p>Once you've got the GPX file, you can
  use <a href='http://freefoote.dview.net/linux_gpscorr.html'>gpscorrelate
  </a>to write the coordinate metadata onto the photo files. This
  program uses the GPX file to figure out where you were at a given
  time and then for each photo makes a best guess that it writes to
  the photo file.</p>

<pre class='code'>
$ gpscorrelate -g myhike.gpx hike_photos/*
</pre>

<p>The one caveat at this point is that often your GPS device and your
  camera will be set to different time zones. If this is the case,
  simply add a <tt>--timeadd +8</tt> to add 8 hours or adjust
  accordingly.</p>

<p>At this point you'll have to upload the photos to Flickr. Note that
  if you've already got the photos in Flickr but they don't have the
  coordinate metadata you'll have to re-upload them. Be sure they are
  tagged with something unique; you'll use Flickr tags to tell
  hiker.rb which to process. The last bit of setup you need is to sign
  up for a <a href='http://www.flickr.com/services/api/keys/apply/'>Flickr
  API key</a>. Place the key in a file in <tt>~/.flickr_key</tt>.</p>

<p>Now you're ready to run the script.</p>

<pre class='code'>
$ ruby hiker.rb myhiketag myusername > myhike.kml
</pre>

<p>So now you've got your shiny new hike KML file. Publish it to the
  web and you'll be able to view it in Google Maps by appending its
  URL to the Google Maps
  URL: <tt><a href='http://maps.google.com/?q=http://hagelb.org/edwards.kml'>http://maps.google.com/?q=http://example.com/myhike.kml</a></tt></p>

<p>Grab <a href='http://dev.technomancy.us/browser/hiker'>the code
    from my repository</a>.</p>

<pre class='code'>
$ git svn clone svn://dev.technomancy.us/hiker
</pre>

<p>Or if you're still doing the centralized VC thing:</p>

<pre class='code'>
$ svn co svn://dev.technomancy.us/hiker
</pre>

<p>That's all! Future revisions may automate the tiresome work of
  running <tt>gpsbabel</tt> and <tt>gpscorrelate</tt>, but this is how
  it works for now. Let me know if you run the script and have any
  feedback; please leave a comment.</p>

        </div>

        <p class='dt'>
          <a href='/92'>Sat Oct 13 00:00:01 -0700 2007</a>
        </p>
      </div>
    </div>

    <p id='foot'>
      &copy; 2004 - 2007 Phil Hagelberg <span title='soli Deo gloria'>SDG</span>
    </p>

  </div><!-- end wrapper -->
  <img src='/static/i/foot.png' alt='' id='corner' style='display: block;' />

</div><!-- end background -->


</body></html>
