<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1' />
    <title>hardware hacks - Technomancy</title>
    <script src="/static/prototype.js" type="text/javascript"></script>

    <link href="http://technomancy.us/feed/atom" rel="alternate" type="application/atom+xml"/>
    <link rel='stylesheet' href='/static/style.css' type='text/css' />
  </head>

  <body>

    <div id='background'>
      <img src='/static/i/top.png' alt='Technomancy' border='0' id='corner' />

      <div id='wrapper'> &nbsp;

      <div id='nav'>
        <ul>
          <li><a href='/'>blog</a></li>
          <li><a href='/resume'>r&eacute;sum&eacute;</a></li>
          <li><a href='/contact'>contact</a></li>
          <li><a href='/meta'>meta</a></li>
          <li><a href='http://dev.technomancy.us'>projects</a></li>
        </ul>

      </div><!-- end nav -->

      <p id='tagline'>Any sufficiently advanced technology is indistinguishable from magic.</p>

      <div id='content'>
        <h2>{ blog }</h2><div id='sidebar'>

        <h3>What you say?</h3>

        <p class='explain'>These are the technology musings of Phil
        Hagelberg. I write Ruby and Javascript code for a living, but I also spend a lot of
        time considering how to do so in the most efficient manner. This
        necessarily involves good-sized chunks of Emacs lisp.</p>

        <p class='explain'>I've got a separate <a href="http://philisha.net">blog for
        personal thoughts</a> and a <a href="http://dev.technomancy.us">wiki</a>
        for my projects.</p>

        <form action='http://www.google.com/search' name='searchbox' method='get'>
          <input type='hidden' name='sitesearch' value='technomancy.us' />
          <input type='text' name='q' size='9' value='Search' class='form-text'
                 onfocus="if (this.value=='Search') value='';"
                 onblur="if (this.value=='') value='Search';" />
          <input type='submit' value='&#187;' class='button' title="Because I didn't want to code search myself" />
        </form>

        <p><a href='/feed/atom' title='Syndication is your friend'><img src='/static/i/feedIcon.png' alt='feed' align='left' /> Feed</a></p>

        <h3>Fellow Hackers</h3>
        <ul>
          <li><a href='http://arko.net/' rel='friend met colleague'>andr&eacute; arko</a></li>
          <li><a href='http://brainspl.at' rel='friend met colleague'>ezra Z</a></li>
          <li><a href='http://blog.livollmers.net/' rel='friend colleague met'>alex</a></li>
          <li><a href='http://userprimary.net/user' rel='frient colleague met'>seth</a></li>
          <li><a href='http://www.lathi.net' rel='friend colleague met'>doug alcorn</a></li>
          <li><a href='http://blog.hasmanythrough.com' rel='friend colleague met'>josh susser</a></li>
          <li><a href='http://yehudakatz.com'>katz</a></li>
          <li><a href='http://evil.che.lu' rel='friend colleague'>evilchelu</a></li>
          <li><a href='http://jw.fi' rel='friend colleague'>unfo-</a></li>
          <li><a href='http://metaatem.com' rel='friend colleague met'>kastner</a></li>
          <li><a href='http://www.anarchaia.org/'>anarchaia</a></li>
          <li><a href='http://blog.codahale.com' rel='friend colleague met'>coda hale</a></li>
          <li><a href='http://gilesbowkett.blogspot.com' rel='colleague'>giles bowkett</a></li>
          <li><a href='http://on-ruby.blogspot.com/' rel='colleague met'>pate</a></li>
          <li><a href='http://schneier.com/blog' title='SecurityInsight'>bruce schneier</a></li>
          <li><a href='http://tbray.org/ongoing' rel='met' title='t1m'>tim bray</a></li>
          <li><a href='http://diveintomark.org'>mark pilgrim</a></li>
          <li><a href='http://intertwingly.net'>sam ruby</a></li>
          <li><a href='http://hackety.org' rel='met'>hackety</a></li>
          <li><a href='http://redhanded.hobix.com/' rel='met' title='Lucky Stiff and Friends'>redHanded</a></li>
          <li><a href='http://eigenclass.org' title="maybe if i read this more often i'll get smarter and understand it">mauricio</a></li>
          <li><a href='http://onestepback.org' title='the santa claus of Ruby'>jim weirich</a></li>
          <li><a href='http://ejohn.org'>john resig</a></li>
          <li><a href='http://steve-yegge.blogspot.com/' title='mostly he is listed because of emacs'>steve yegge</a></li>
        </ul>

        <h3 title='aggregation is key here'>Communities</h3>
        <ul>
          <li><a href='http://planet.lisp.org' title="(grok 'lisp)">planet lisp</a></li>
          <li><a href='http://planet.emacsen.org' title='denizens of #emacs'>planet emacs</a></li>
          <li><a href='http://planetruby.0x42.net' title='Yes, it runs on Python'>planet ruby</a></li>
          <li><a href='http://planet.caboo.se' title='my latest planet'>planet caboose</a></li>
          <li><a href='http://planet.ubuntu.com' title='humanity'>planet ubuntu</a></li>
          <li><a href='http://planet.mozilla.org' title='Gecko will save us'>planet mozilla</a></li>
          <li><a href='http://radar.oreilly.com/' title='there are those that call me... tim'>planet o'reilly</a></li>
        </ul>

        <h3><a href='http://dev.technomancy.us/'>Projects</a></h3>
        <ul>
          <li><a href='http://bus-scheme.rubyforge.org'>bus scheme</a></li>
          <li><a href='http://augment.rubyforge.org'>augment</a></li>
          <li><a href='http://www.emacswiki.org/cgi-bin/wiki/ElUnit' title='Emacs Lisp TDD'>elunit</a></li>
          <li><a href='http://rinari.rubyforge.org' title='rails emacs mode'>rinari</a></li>
          <li><a href='http://concour.se' title='railsday 06 project'>Concourse</a></li>
          <li><a href='http://rubyforge.org/projects/rplanet' title='Feed Aggregator'>rPlanet</a></li>
          <li><a href='http://rav.rubyforge.org/' title='Rails Application Visualizer'>rav</a></li>
          <li><a href='http://cartographer.rubyforge.org' title='Google Maps in Rails'>Cartographer</a></li>
          <li><a href='http://dev.technomancy.us/ebby' title='collaborative editing with Emacs'>ebby</a></li>
        </ul>

      </div><!-- end sidebar -->

      <div class='post'>
        <h3><a href='/70'>hardware hacks</a></h3>

        <div>
          <p><a
      href='http://dev.technomancy.us/phil/wiki/NorbertRobot'>Norbert</a>
      is my latest project: a robot that I plan on building up and
      programming.</p>

<img src='/static/i/die_roboter.jpg' 
     alt='die roboter' title='die roboter' align='right' />


<p>I've got the motor hooked up and running, "mocking out" the control
  logic to a pair of switches. The plan is to get my laptop on board
  and control the motors through the serial port. Apparently the
  circuitry for such a task involves using a UART chip to convert the
  serial signals into something usable, which is going to be a bit of
  a challenge for me; I haven't worked with ICs before.</p>

<p>Currently Norbert is capable of backward and forward motion as well
  as turning, though the limitation of using switches on the chassis
  makes control somewhat impractical.</p>

<p>The plan is all laid out in terms of what revisions will include
  what features:</p>

<ol>
  <li>Simple motion (done)</li>
  <li>Turning capability through switches (done)</li>
  <li>Platform on which to mount laptop (done)</li>
  <li>Laptop controls forward motion</li>
  <li>Laptop controls turning</li>
  <li>Laptop controls forward/reverse</li>
  <li>Autonomy (laptop can be provided with a predetermined path to
    follow rather than requiring input each step of the way)</li>
  <li>Bump sensors so that it will stop rather than keep pushing into an
    unyielding object </li>
  <li>... and more brainstorming
  on <a href='http://dev.technomancy.us/phil/wiki/NorbertRobot'>the
  wiki page</a>.</li>
</ol>

<p>(<i>Italics</i> indicate completed revisions.)</p>

<img src='/static/i/norbert.jpg' alt='norbert'
     title="lil' norbert" />

<p>I drummed up a bit of code for the controller before I had really
  decided on parallel vs serial. (I had an old laptop I was
  considering using that had an easier-to-interface-with parallel
  port, but it was lacking a battery.) Hopefully it shouldn't be too difficult
  to modify it to use the <a href='http://ruby-serialport.rubyforge.org'>
    ruby-serialport</a> library.</p>

    <pre class='code'>
<span class="keyword">class</span> <span class="type">Robot</span>
  <span class="type">COMMAND_BITS</span> = [<span class="constant">:right_motor_forward</span>, <span class="constant">:right_motor_backward</span>,
    <span class="constant">:left_motor_forward</span>, <span class="constant">:left_motor_backward</span>]

  <span class="keyword">def</span> <span class="function-name">go_forward</span>
    write_byte aggregate_commands(<span class="constant">:right_motor_forward</span>, <span class="constant">:left_motor_forward</span>)
  <span class="keyword">end</span>

  <span class="comment-delimiter"># </span><span class="comment">[go_backward and other commands...]
</span>  
  <span class="keyword">def</span> <span class="function-name">aggregate_commands</span>(*commands)
    commands.inject(0) <span class="keyword">do</span> |aggregate, command|
      aggregate | bit_place(<span class="type">COMMAND_BITS</span>.index(command))
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  <span class="keyword">def</span> <span class="function-name">bit_place</span>(place)
    (2 ** place)
  <span class="keyword">end</span>

  <span class="keyword">def</span> <span class="function-name">write_byte</span>(byte)
    <span class="comment-delimiter"># </span><span class="comment">http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/24605
</span>    p = open(<span class="string">'/dev/port'</span>, <span class="string">'w'</span>)  <span class="comment-delimiter"># </span><span class="comment">open /dev/port in write mode
</span>    p.sync = <span class="variable-name">true</span>               <span class="comment-delimiter"># </span><span class="comment">turn buffering off, write to the
</span>                                <span class="comment-delimiter"># </span><span class="comment">port as soon as it is requested
</span>    p.seek(0x378, <span class="type">IO</span>::<span class="type">SEEK_SET</span>) <span class="comment-delimiter"># </span><span class="comment">move writing cursor to the parallel
</span>                                <span class="comment-delimiter"># </span><span class="comment">port address
</span>    p.putc(byte)                <span class="comment-delimiter"># </span><span class="comment">write byte to it and activate
</span>                                <span class="comment-delimiter"># </span><span class="comment">whatever on your I/O board is 
</span>                                <span class="comment-delimiter"># </span><span class="comment">attached to the D0 pin
  <span class="keyword">end</span>
<span class="keyword">end</span>
</pre>


        </div>

        <p class='dt'>
          <a href='/70'>Sat Oct 13 00:00:01 -0700 2007</a>
        </p>
      </div>
    </div>

    <p id='foot'>
      &copy; 2004 - 2007 Phil Hagelberg <span title='soli Deo gloria'>SDG</span>
    </p>

  </div><!-- end wrapper -->
  <img src='/static/i/foot.png' alt='' id='corner' style='display: block;' />

</div><!-- end background -->


</body></html>
