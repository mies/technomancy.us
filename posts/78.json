{"timestamp":"Sat Oct 13 00:00:01 -0700 2007","DRAFT":null,"title":"mail jig","id":78,"content":"<p>In the same vein as Ryan\nDavis' <a\nhref=\"http:\/\/blog.zenspider.com\/archives\/2007\/03\/that_stupid_thing_i_wrote_the_other_day_part_1.html\">That\nStupid Thing I Wrote The Other Day<\/a> series; maybe this will be useful to someone:<\/p>\n\n    <pre class=\"code\">\n<span class=\"comment-delimiter\">#<\/span><span class=\"comment\">!\/bin\/sh<\/span><span class=\"comment\">\n<\/span>\n<span class=\"comment-delimiter\"># <\/span><span class=\"comment\">On my desktop, I only want mail to be checked if I'm using the\n<\/span><span class=\"comment-delimiter\"># <\/span><span class=\"comment\">machine. Otherwise I want it to leave the mail on the server so my\n<\/span><span class=\"comment-delimiter\"># <\/span><span class=\"comment\">laptop can fetch it.\n<\/span>\n<span class=\"comment-delimiter\"># <\/span><span class=\"comment\">idletime gets touched every three minutes while idle\n<\/span>xautolock -time 3 -locker <span class=\"string\">\"touch ~\/.idle\"<\/span> &amp;\n\n<span class=\"comment-delimiter\"># <\/span><span class=\"comment\">keep the mail on the server if i'm on my laptop\n<\/span><span class=\"keyword\">if<\/span> [ <span class=\"string\">`hostname`<\/span> = <span class=\"string\">\"vannevar\"<\/span> ] ; <span class=\"keyword\">then<\/span>\n    <span class=\"variable-name\">KEEP<\/span>=<span class=\"string\">'-k'<\/span>\n<span class=\"keyword\">fi<\/span>\n\n<span class=\"keyword\">while<\/span> [ 1 ]\n<span class=\"keyword\">do<\/span>\n    touch ~\/.three.minutes.old\n    sleep 3m\n\n    <span class=\"keyword\">if<\/span> [ ~\/.idle -ot ~\/.three.minutes.old ]; <span class=\"keyword\">then<\/span>\n        <span class=\"comment-delimiter\"># <\/span><span class=\"comment\">not idle!\n<\/span>        fetchmail -k &gt;\/dev\/null 2&gt;&amp;1\n\n        <span class=\"keyword\">if<\/span> [ <span class=\"string\">\"$?\"<\/span> = <span class=\"string\">\"0\"<\/span> ]; <span class=\"keyword\">then<\/span>\n            notify-send -u low <span class=\"string\">\"New mail\"<\/span>\n        <span class=\"keyword\">fi<\/span>\n    <span class=\"keyword\">fi<\/span>\n<span class=\"keyword\">done<\/span>\n\n<\/pre>\n\n<p>I've got a laptop and a desktop. I want to check mail on the\ndesktop and have that act as the definitive copy. So when the desktop\npulls in mail, it deletes it off the server. I want to use the laptop\nto pull in mail, but only when I'm not at my desktop. It keeps a\nnon-authoritative copy that may have vast holes in its archives; no\nbig deal.<\/p>\n\n<p>The problem is, I don't want mail to get checked when I'm away from\nmy desktop. I could just manually start and stop the fetchmail d&aelig;mon,\nbut that's tacky. This script uses xautolock to determine the idle\ntime of X. If it's been active in the last three minutes, it should\npull in the mail; otherwise leave it alone. If it's on my laptop\n(vannevar) then keep mail on the server for my desktop to consume.<\/p>\n\n<p>As you can see, I'm no shell wizard. Using hidden files is slightly\ntacky, but it gets the job done.<\/p>"}
