{"timestamp":"Sat Oct 13 00:00:01 -0700 2007","DRAFT":null,"title":"post-railsconf 07","id":82,"content":"<p>RailsConf just ended. I've got a big refactoring\r\nof <a href='http:\/\/rav.rubyforge.org'>RAV<\/a> in the works, but until\r\nI wrap that up I'll post this to hold things over:<\/p>\r\n\r\n<img src='\/static\/i\/mongrel_panel.png' alt='mongrel panel screenshot' \/>\r\n\r\n<p>It may be hypocritical of me to keep harping on how it's best to avoid reliance on the mouse as much as you can, but  I grudgingly admit that sometimes it <i>is<\/i> handy to be able to launch mongrel quickly with it. Below is the code for <tt>mongrel_panel.rb<\/tt>:<\/p>\r\n\r\n<pre class='code' style='font-size: 90%;'>\r\n<span class=\"comment-delimiter\">#<\/span><span class=\"comment\">!\/usr\/bin\/env ruby\r\n<\/span>\r\n<span class=\"comment-delimiter\"># <\/span><span class=\"comment\">Mongrel Panel\r\n<\/span><span class=\"comment-delimiter\"># <\/span><span class=\"comment\">Copyright (C) 2007 Phil Hagelberg\r\n<\/span>\r\nrequire <span class=\"string\">'gtk2'<\/span>\r\nrequire <span class=\"string\">'gtktrayicon'<\/span>\r\n\r\n<span class=\"type\">RAILS_ROOT<\/span> = <span class=\"type\">ENV<\/span>[<span class=\"string\">'RAILS_ROOT'<\/span>] || <span class=\"string\">'.'<\/span>\r\n\r\nmongrel = <span class=\"type\">Gtk<\/span>::<span class=\"type\">TrayIcon<\/span>.new(<span class=\"string\">\"mongrel\"<\/span>)\r\n\r\n<span class=\"variable-name\">$started<\/span> = <span class=\"type\">File<\/span>.exist? <span class=\"type\">RAILS_ROOT<\/span> + <span class=\"string\">'\/log\/mongrel.pid'<\/span>\r\nbutton = <span class=\"type\">Gtk<\/span>::<span class=\"type\">Button<\/span>.new(<span class=\"string\">\"\"<\/span>, <span class=\"variable-name\">true<\/span>)\r\nbutton.image = <span class=\"type\">Gtk<\/span>::<span class=\"type\">Image<\/span>.new(<span class=\"string\">\"<\/span><span class=\"variable-name\">#{File.dirname(__FILE__)}<\/span><span class=\"string\">\/mong<\/span><span class=\"variable-name\">#{ \\\r\n    '_mono' unless $started}<\/span><span class=\"string\">.png\"<\/span>)\r\nbutton.relief = <span class=\"type\">Gtk<\/span>::<span class=\"type\">RELIEF_NONE<\/span>\r\n\r\nbutton.signal_connect(<span class=\"string\">'clicked'<\/span>) <span class=\"keyword\">do<\/span>\r\n  <span class=\"keyword\">if<\/span> <span class=\"variable-name\">$started<\/span>\r\n    button.image = <span class=\"type\">Gtk<\/span>::<span class=\"type\">Image<\/span>.new(<span class=\"string\">\"<\/span><span class=\"variable-name\">#{File.dirname(__FILE__)}<\/span><span class=\"string\">\/mong_mono.png\"<\/span>)\r\n    <span class=\"string\">`mongrel_rails stop -c <\/span><span class=\"variable-name\">#{RAILS_ROOT}<\/span><span class=\"string\">`<\/span>\r\n    <span class=\"variable-name\">$started<\/span> = <span class=\"variable-name\">false<\/span>\r\n  <span class=\"keyword\">else<\/span>\r\n    button.image = <span class=\"type\">Gtk<\/span>::<span class=\"type\">Image<\/span>.new(<span class=\"string\">\"<\/span><span class=\"variable-name\">#{File.dirname(__FILE__)}<\/span><span class=\"string\">\/mong.png\"<\/span>)\r\n    <span class=\"string\">`mongrel_rails start -c <\/span><span class=\"variable-name\">#{RAILS_ROOT}<\/span><span class=\"string\"> -d`<\/span>\r\n    <span class=\"variable-name\">$started<\/span> = <span class=\"variable-name\">true<\/span>\r\n  <span class=\"keyword\">end<\/span>\r\n<span class=\"keyword\">end<\/span>\r\n\r\nmongrel.add(button)\r\nmongrel.show_all\r\n<span class=\"type\">Gtk<\/span>.main\r\n<\/pre>\r\n\r\n<p>I feel like I keep harping on this, but man... GUI code is <i>weird<\/i> and unintuitive for me. Probably just a matter of familiarizing myself with the conventions, but still. On Ubuntu\/Debian: <tt>sudo apt-get install libgnome2-ruby libgtk-trayicon-ruby1.8<\/tt> then <a href='\/static\/code\/mongrel_panel.tar.gz'>grab it<\/a>.<\/p>\r\n\r\n<p>Usage: <tt>RAILS_ROOT=~\/projects\/foo mongrel_panel.rb &<\/tt> or run it from your rails root.<\/p>\r\n\r\n<p>This is nothing really, but it might be a nice base to adapt for other similar d&aelig;mons, I suppose. Let me know if you find it useful.<\/p>"}
